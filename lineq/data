############################################################
# Exercise A - QR-decomp by Gram-Schmidt orthogonalization #
############################################################
# Part one - Orthogonalization of a nxm (n>m) Matrix A #
########################################################
# Matrix A
 0.8402	 0.3944	 0.7831	
 0.7984	 0.9116	 0.1976	
 0.3352	 0.7682	 0.2778	
 0.5540	 0.4774	 0.6289	
 0.3648	 0.5134	 0.9522	
 0.9162	 0.6357	 0.7173	

# Q^T * Q = 
 1.0000	 0.0000	-0.0000	
 0.0000	 1.0000	 0.0000	
-0.0000	 0.0000	 1.0000	

# Matrix R
 1.6538	 1.4215	 1.3676	
 0.0000	 0.6721	 0.0051	
 0.0000	 0.0000	 0.8221	

# QR = A 
 0.8402	 0.3944	 0.7831	
 0.7984	 0.9116	 0.1976	
 0.3352	 0.7682	 0.2778	
 0.5540	 0.4774	 0.6289	
 0.3648	 0.5134	 0.9522	
 0.9162	 0.6357	 0.7173	

############################
# Part two - solve QRx = b #
############################
# matrix A(n,n)
 0.1416	 0.6070	 0.0163	 0.2429	 0.1372	 0.8042	
 0.4009	 0.1298	 0.1088	 0.9989	 0.2183	 0.5129	
 0.6126	 0.2960	 0.6376	 0.5243	 0.4936	 0.9728	
 0.7714	 0.5267	 0.7699	 0.4002	 0.8915	 0.2833	
 0.8077	 0.9190	 0.0698	 0.9493	 0.5260	 0.0861	
 0.6632	 0.8902	 0.3489	 0.0642	 0.0200	 0.4577	

# Vector b(n)
0.15668
0.83911
0.29252
0.35246
0.19221
0.06310

# Solving for x in QRx = b
-4.37956
1.95142
4.60677
2.83309
-1.85658
-1.13911

# A x = b =
0.15668
0.83911
0.29252
0.35246
0.19221
0.06310

################################################################
# Exercise B - Matrix inverse by Gram-Schmidt QR factorization #
################################################################
# A =
 0.8402	 0.3944	 0.7831	 0.7984	 0.9116	 0.1976	
 0.3352	 0.7682	 0.2778	 0.5540	 0.4774	 0.6289	
 0.3648	 0.5134	 0.9522	 0.9162	 0.6357	 0.7173	
 0.1416	 0.6070	 0.0163	 0.2429	 0.1372	 0.8042	
 0.1567	 0.4009	 0.1298	 0.1088	 0.9989	 0.2183	
 0.5129	 0.8391	 0.6126	 0.2960	 0.6376	 0.5243	

# A^-1 
 2.0685	-1.6896	-1.3136	 2.0038	-0.6824	 0.2550	
-1.2135	 3.0653	-0.5024	-2.2473	-0.4261	 1.0923	
-0.6859	-1.2429	 1.1074	-0.6999	-0.3041	 1.4342	
 0.0702	 2.7353	 0.2787	-1.2344	-0.3177	-1.6631	
 0.1300	-0.5051	 0.1281	 0.1697	 1.2822	-0.4125	
 0.5222	-2.7308	 0.4820	 2.9450	 0.3251	-0.3258	

# A * A^-1 = I = 
 1.0000	 0.0000	-0.0000	-0.0000	 0.0000	 0.0000	
 0.0000	 1.0000	-0.0000	 0.0000	-0.0000	 0.0000	
-0.0000	-0.0000	 1.0000	-0.0000	 0.0000	 0.0000	
-0.0000	-0.0000	 0.0000	 1.0000	 0.0000	-0.0000	
-0.0000	 0.0000	-0.0000	 0.0000	 1.0000	-0.0000	
 0.0000	 0.0000	 0.0000	 0.0000	-0.0000	 1.0000	

#############################################
# Exercise C - QR-decomp by Givens rotation #
#############################################
# Part one - Orthogonalization of a nxm (n>m) Matrix A #
########################################################
# Matrix A
 0.8402	 0.3944	 0.7831	
 0.7984	 0.9116	 0.1976	
 0.3352	 0.7682	 0.2778	
 0.5540	 0.4774	 0.6289	
 0.3648	 0.5134	 0.9522	
 0.9162	 0.6357	 0.7173	

# Q^T * Q = 
 1.0000	 0.0000	 0.0000	
 0.0000	 1.0000	-0.0000	
 0.0000	-0.0000	 1.0000	

# Matrix R isn't calculated as in Gram-Schmidt, so we get it by:
# R = Q^T A since Q is an orthogonal matrix
 1.6538	 1.4215	 1.3676	
 0.0000	 0.6721	 0.0051	
-0.0000	-0.0000	 0.8221	

# This shows that QR = A 
 1.3895	 1.4594	 1.7948	
 1.3205	 1.7477	 1.2589	
 0.5544	 0.9928	 0.6907	
 0.9162	 1.1083	 1.2770	
 0.6033	 0.8636	 1.2843	
 1.5152	 1.7296	 1.8459	

############################
# Part two - solve QRx = b #
############################
# matrix A(n,n) = 
 0.1416	 0.6070	 0.0163	 0.2429	 0.1372	 0.8042	
 0.4009	 0.1298	 0.1088	 0.9989	 0.2183	 0.5129	
 0.6126	 0.2960	 0.6376	 0.5243	 0.4936	 0.9728	
 0.7714	 0.5267	 0.7699	 0.4002	 0.8915	 0.2833	
 0.8077	 0.9190	 0.0698	 0.9493	 0.5260	 0.0861	
 0.6632	 0.8902	 0.3489	 0.0642	 0.0200	 0.4577	

# Vector b(n) = 
0.15668
0.83911
0.29252
0.35246
0.19221
0.06310

# Solving for x in QRx = b
-4.37956
1.95142
4.60677
2.83309
-1.85658
-1.13911

# A x = b =
0.15668
0.83911
0.29252
0.35246
0.19221
0.06310

######################################
# Matrix inverse by Givens rotations #
######################################
# A =
 0.1416	 0.6070	 0.0163	 0.2429	 0.1372	 0.8042	
 0.4009	 0.1298	 0.1088	 0.9989	 0.2183	 0.5129	
 0.6126	 0.2960	 0.6376	 0.5243	 0.4936	 0.9728	
 0.7714	 0.5267	 0.7699	 0.4002	 0.8915	 0.2833	
 0.8077	 0.9190	 0.0698	 0.9493	 0.5260	 0.0861	
 0.6632	 0.8902	 0.3489	 0.0642	 0.0200	 0.4577	

# A^-1 = 
-3.6393	-6.1477	 8.1344	-5.5653	 5.3598	-1.5676	
 1.9863	 2.7332	-4.3871	 2.7251	-2.2116	 1.5001	
 1.6171	 6.4997	-7.3007	 5.5311	-5.7592	 3.0502	
 0.9811	 4.0094	-3.9049	 2.3839	-2.3357	 1.0458	
 0.1273	-3.1409	 2.7416	-0.9658	 2.3257	-2.3701	
 0.0343	-1.7872	 2.7384	-1.7442	 1.1508	-0.8294	

# A * A^-1 = I = 
 1.0000	 0.0000	 0.0000	-0.0000	 0.0000	-0.0000	
 0.0000	 1.0000	 0.0000	-0.0000	-0.0000	-0.0000	
 0.0000	 0.0000	 1.0000	 0.0000	-0.0000	 0.0000	
 0.0000	 0.0000	 0.0000	 1.0000	-0.0000	 0.0000	
 0.0000	 0.0000	 0.0000	-0.0000	 1.0000	-0.0000	
 0.0000	 0.0000	 0.0000	-0.0000	 0.0000	 1.0000	

