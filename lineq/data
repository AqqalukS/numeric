############################################################
# Exercise A - QR-decomp by Gram-Schmidt orthogonalization #
############################################################
# Part one - Orthogonalization of a nxm (n>m) Matrix A #
########################################################
# Matrix A
 0.0000	 0.1315	 0.7556	
 0.4587	 0.5328	 0.2190	
 0.0470	 0.6789	 0.6793	
 0.9347	 0.3835	 0.5194	
 0.8310	 0.0346	 0.0535	
 0.5297	 0.6711	 0.0077	

# Q^T * Q = 
 1.0000	-0.0000	-0.0000	
-0.0000	 1.0000	-0.0000	
-0.0000	-0.0000	 1.0000	

# Matrix R
 1.4343	 0.7104	 0.4646	
 0.0000	 0.9252	 0.5981	
 0.0000	 0.0000	 0.8829	

# QR = A 
 0.0000	 0.1315	 0.7556	
 0.4587	 0.5328	 0.2190	
 0.0470	 0.6789	 0.6793	
 0.9347	 0.3835	 0.5194	
 0.8310	 0.0346	 0.0535	
 0.5297	 0.6711	 0.0077	

############################
# Part two - solve QRx = b #
############################
# matrix A(n,n)
 0.3834	 0.0668	 0.4175	 0.6868	 0.5890	 0.9304	
 0.5269	 0.0920	 0.6539	 0.4160	 0.7012	 0.9103	
 0.2625	 0.0475	 0.7361	 0.3282	 0.6326	 0.7564	
 0.3653	 0.2470	 0.9826	 0.7227	 0.7534	 0.6515	
 0.6316	 0.8847	 0.2727	 0.4364	 0.7665	 0.4777	
 0.2749	 0.3593	 0.1665	 0.4865	 0.8977	 0.9092	

# Vector b(n)
0.84617
0.76220
0.99104
0.07269
0.23777
0.06056

# Solving for x in QRx = b
-2.16517
4.48839
2.10600
-1.74892
-6.56895
5.98338

# A x = b =
0.84617
0.76220
0.99104
0.07269
0.23777
0.06056

################################################################
# Exercise B - Matrix inverse by Gram-Schmidt QR factorization #
################################################################
# A =
 0.0000	 0.1315	 0.7556	 0.4587	 0.5328	 0.2190	
 0.0470	 0.6789	 0.6793	 0.9347	 0.3835	 0.5194	
 0.8310	 0.0346	 0.0535	 0.5297	 0.6711	 0.0077	
 0.3834	 0.0668	 0.4175	 0.6868	 0.5890	 0.9304	
 0.8462	 0.5269	 0.0920	 0.6539	 0.4160	 0.7012	
 0.9103	 0.7622	 0.2625	 0.0475	 0.7361	 0.3282	

# A^-1 
 3.3379	-2.4718	-0.7693	-2.1876	 4.1884	-1.0433	
-1.6462	 1.5643	-0.0191	 0.0548	-1.1980	 1.0271	
 4.9137	-2.5005	-1.6310	-2.3982	 4.0501	-1.1366	
-0.6624	 1.0339	 0.9255	-0.0910	-0.0813	-0.7844	
-3.9109	 2.3656	 1.8522	 2.9543	-5.3826	 1.9460	
-0.4975	-0.2325	-0.8054	 1.2455	 0.0101	 0.2133	

# A * A^-1 = I = 
 1.0000	-0.0000	 0.0000	 0.0000	-0.0000	 0.0000	
 0.0000	 1.0000	 0.0000	 0.0000	-0.0000	 0.0000	
 0.0000	 0.0000	 1.0000	-0.0000	 0.0000	-0.0000	
 0.0000	 0.0000	-0.0000	 1.0000	-0.0000	-0.0000	
-0.0000	-0.0000	 0.0000	-0.0000	 1.0000	-0.0000	
 0.0000	-0.0000	-0.0000	-0.0000	-0.0000	 1.0000	

#############################################
# Exercise C - QR-decomp by Givens rotation #
#############################################
# Part one - Orthogonalization of a nxm (n>m) Matrix A #
########################################################
# Matrix A
 0.0000	 0.1315	 0.7556	
 0.4587	 0.5328	 0.2190	
 0.0470	 0.6789	 0.6793	
 0.9347	 0.3835	 0.5194	
 0.8310	 0.0346	 0.0535	
 0.5297	 0.6711	 0.0077	

# Q^T * Q = 
 1.0000	-0.0000	 0.0000	
-0.0000	 1.0000	 0.0000	
 0.0000	 0.0000	 1.0000	

# Matrix R isn't calculated as in Gram-Schmidt, so we get it by:
# R = Q^T A since Q is an orthogonal matrix
 1.4343	 0.7104	 0.4646	
-0.0000	 0.9252	 0.5981	
 0.0000	 0.0000	 0.8829	

# This shows that QR = A 
 0.0000	 0.1217	 0.7458	
 0.6579	 0.8188	 0.7250	
 0.0675	 0.6615	 1.0276	
 1.3407	 1.0188	 1.1222	
 1.1919	 0.6223	 0.4539	
 0.7598	 0.9973	 0.6543	

############################
# Part two - solve QRx = b #
############################
# matrix A(n,n) = 
 0.3834	 0.0668	 0.4175	 0.6868	 0.5890	 0.9304	
 0.5269	 0.0920	 0.6539	 0.4160	 0.7012	 0.9103	
 0.2625	 0.0475	 0.7361	 0.3282	 0.6326	 0.7564	
 0.3653	 0.2470	 0.9826	 0.7227	 0.7534	 0.6515	
 0.6316	 0.8847	 0.2727	 0.4364	 0.7665	 0.4777	
 0.2749	 0.3593	 0.1665	 0.4865	 0.8977	 0.9092	

# Vector b(n) = 
0.84617
0.76220
0.99104
0.07269
0.23777
0.06056

# Solving for x in QRx = b
-2.16517
4.48839
2.10600
-1.74892
-6.56895
5.98338

# A x = b =
0.84617
0.76220
0.99104
0.07269
0.23777
0.06056

######################################
# Matrix inverse by Givens rotations #
######################################
# A =
 0.3834	 0.0668	 0.4175	 0.6868	 0.5890	 0.9304	
 0.5269	 0.0920	 0.6539	 0.4160	 0.7012	 0.9103	
 0.2625	 0.0475	 0.7361	 0.3282	 0.6326	 0.7564	
 0.3653	 0.2470	 0.9826	 0.7227	 0.7534	 0.6515	
 0.6316	 0.8847	 0.2727	 0.4364	 0.7665	 0.4777	
 0.2749	 0.3593	 0.1665	 0.4865	 0.8977	 0.9092	

# A^-1 = 
-1.5065	 5.3553	-4.9865	 0.9417	-0.3783	-0.1477	
 2.7315	-5.4382	 6.0423	-2.4684	 2.6714	-2.0122	
 0.4387	-1.6359	 2.9631	-0.2296	 0.6273	-1.4412	
 1.2057	-0.3202	-2.5688	 1.7220	-0.5043	 0.2549	
-4.9731	 5.2114	-6.3091	 3.3589	-2.3738	 3.9607	
 3.5606	-4.1446	 6.1810	-3.5050	 1.5574	-1.8432	

# A * A^-1 = I = 
 1.0000	-0.0000	 0.0000	-0.0000	 0.0000	-0.0000	
 0.0000	 1.0000	 0.0000	-0.0000	 0.0000	-0.0000	
 0.0000	-0.0000	 1.0000	-0.0000	 0.0000	-0.0000	
 0.0000	-0.0000	 0.0000	 1.0000	 0.0000	-0.0000	
 0.0000	 0.0000	 0.0000	-0.0000	 1.0000	-0.0000	
-0.0000	-0.0000	-0.0000	 0.0000	 0.0000	 1.0000	

